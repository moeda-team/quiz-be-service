generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model users {
  id       String @id @default(uuid()) @db.VarChar(36)
  name     String @db.VarChar(100)
  email    String @unique @db.VarChar(100)
  password String @db.VarChar(255)
  role     String @default("student") @db.VarChar(20)

  created_at DateTime  @default(now())
  created_by String    @db.VarChar(36)
  updated_at DateTime? @updatedAt
  updated_by String?   @db.VarChar(36)
  deleted_at DateTime?
  deleted_by String?   @db.VarChar(36)

  classes_taught  classes[]         @relation("TeacherClasses")
  student_classes student_classes[]
  submissions     submissions[]
  notifications   notifications[]
  activities      activities[]
  schedules       schedules[]
}

model reset_password {
  id    String @id @default(uuid()) @db.VarChar(36)
  email String @db.VarChar(100)

  created_at DateTime  @default(now())
  created_by String    @db.VarChar(36)
  updated_at DateTime? @updatedAt
  updated_by String?   @db.VarChar(36)
  deleted_at DateTime?
  deleted_by String?   @db.VarChar(36)
}

model classes {
  id          String  @id @default(uuid())
  name        String
  description String?
  teacher_id  String
  subject     String
  room        String?

  teacher   users             @relation("TeacherClasses", fields: [teacher_id], references: [id])
  schedules schedules[]
  students  student_classes[]
  tasks     tasks[]

  created_at DateTime  @default(now())
  created_by String    @db.VarChar(36)
  updated_at DateTime? @updatedAt
  updated_by String?   @db.VarChar(36)
  deleted_at DateTime?
  deleted_by String?   @db.VarChar(36)
  courses    courses[]
}

model student_classes {
  id         String @id @default(uuid())
  class_id   String
  student_id String

  student users   @relation(fields: [student_id], references: [id])
  class   classes @relation(fields: [class_id], references: [id])

  created_at DateTime  @default(now())
  created_by String    @db.VarChar(36)
  updated_at DateTime? @updatedAt
  updated_by String?   @db.VarChar(36)
  deleted_at DateTime?
  deleted_by String?   @db.VarChar(36)
  courses    courses?  @relation(fields: [coursesId], references: [id])
  coursesId  String?
}

model schedules {
  id         String @id @default(uuid())
  class_id   String
  teacher_id String
  day        String
  start_time String
  end_time   String

  class   classes @relation(fields: [class_id], references: [id])
  teacher users   @relation(fields: [teacher_id], references: [id])

  created_at DateTime  @default(now())
  created_by String    @db.VarChar(36)
  updated_at DateTime? @updatedAt
  updated_by String?   @db.VarChar(36)
  deleted_at DateTime?
  deleted_by String?   @db.VarChar(36)
  courses    courses?  @relation(fields: [coursesId], references: [id])
  coursesId  String?
}

model courses {
  id          String  @id @default(uuid())
  class_id    String
  name        String
  description String?
  video_title String?
  video       String?
  order       Int

  class           classes            @relation(fields: [class_id], references: [id])
  schedules       schedules[]
  students        student_classes[]
  tasks           tasks[]
  courseMaterials course_materials[]

  created_at DateTime  @default(now())
  created_by String    @db.VarChar(36)
  updated_at DateTime? @updatedAt
  updated_by String?   @db.VarChar(36)
  deleted_at DateTime?
  deleted_by String?   @db.VarChar(36)
}

model course_materials {
  id          String  @id @default(uuid())
  course_id   String
  title       String
  description String?
  file        String?

  course courses @relation(fields: [course_id], references: [id])

  created_at DateTime  @default(now())
  created_by String    @db.VarChar(36)
  updated_at DateTime? @updatedAt
  updated_by String?   @db.VarChar(36)
  deleted_at DateTime?
  deleted_by String?   @db.VarChar(36)
}

model tasks {
  id          String   @id @default(uuid())
  class_id    String
  title       String
  description String?
  due_date    DateTime
  type        String

  class       classes       @relation(fields: [class_id], references: [id])
  submissions submissions[]

  created_at DateTime  @default(now())
  created_by String    @db.VarChar(36)
  updated_at DateTime? @updatedAt
  updated_by String?   @db.VarChar(36)
  deleted_at DateTime?
  deleted_by String?   @db.VarChar(36)
  courses    courses?  @relation(fields: [coursesId], references: [id])
  coursesId  String?
}

model submissions {
  id           String   @id @default(uuid())
  task_id      String
  student_id   String
  content      String?
  score        Float?
  submitted_at DateTime @default(now())

  task    tasks @relation(fields: [task_id], references: [id])
  student users @relation(fields: [student_id], references: [id])

  created_at DateTime  @default(now())
  created_by String    @db.VarChar(36)
  updated_at DateTime? @updatedAt
  updated_by String?   @db.VarChar(36)
  deleted_at DateTime?
  deleted_by String?   @db.VarChar(36)
}

model activities {
  id         String   @id @default(uuid())
  student_id String
  activity   String
  timestamp  DateTime @default(now())

  student users @relation(fields: [student_id], references: [id])

  created_at DateTime  @default(now())
  created_by String    @db.VarChar(36)
  updated_at DateTime? @updatedAt
  updated_by String?   @db.VarChar(36)
  deleted_at DateTime?
  deleted_by String?   @db.VarChar(36)
}

model notifications {
  id         String   @id @default(uuid())
  user_id    String
  title      String
  message    String
  is_read    Boolean  @default(false)
  created_at DateTime @default(now())

  user users @relation(fields: [user_id], references: [id])

  updated_at DateTime? @updatedAt
  updated_by String?   @db.VarChar(36)
  deleted_at DateTime?
  deleted_by String?   @db.VarChar(36)
}
